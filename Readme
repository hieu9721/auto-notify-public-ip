# ğŸŒ IP Monitor Bot

Bot theo dÃµi Ä‘á»‹a chá»‰ IP public vÃ  gá»­i thÃ´ng bÃ¡o tá»± Ä‘á»™ng khi cÃ³ thay Ä‘á»•i. Há»— trá»£ thÃ´ng bÃ¡o qua Email, Telegram vÃ  Discord.

## âœ¨ TÃ­nh nÄƒng

- ğŸ”„ **Theo dÃµi IP liÃªn tá»¥c** vá»›i khoáº£ng thá»i gian tÃ¹y chá»‰nh
- ğŸ“§ **ThÃ´ng bÃ¡o Ä‘a kÃªnh**: Email, Telegram, Discord
- ğŸ“ **Ghi log chi tiáº¿t** vá»›i timestamp
- ğŸ”„ **KhÃ´i phá»¥c tá»± Ä‘á»™ng** khi gáº·p lá»—i
- âš™ï¸ **Cháº¡y nhÆ° systemd service** hoáº·c thá»§ cÃ´ng
- ğŸ›¡ï¸ **Backup multiple IP services** Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»™ tin cáº­y
- ğŸ¯ **Lightweight** - chá»‰ cáº§n 1 dependency duy nháº¥t

## ğŸ“‹ YÃªu cáº§u há»‡ thá»‘ng

- **Python 3.6+**
- **Linux** (Ubuntu, CentOS, Debian, Arch, etc.)
- **Internet connection**
- **pip3** hoáº·c **python3-pip**

## ğŸš€ CÃ i Ä‘áº·t nhanh

### 1. Clone hoáº·c táº£i project
```bash
mkdir ~/ip-monitor-bot
cd ~/ip-monitor-bot
```

### 2. Táº¡o cÃ¡c file chÃ­nh
Táº¡o file `ip_monitor.py` vá»›i code tá»« repository nÃ y.

### 3. CÃ i Ä‘áº·t dependencies
```bash
pip3 install requests
```

### 4. Táº¡o file cáº¥u hÃ¬nh
```bash
cat > config.json << 'EOF'
{
  "check_interval": 300,
  "notification_methods": ["email"],
  "email": {
    "smtp_server": "smtp.gmail.com",
    "smtp_port": 587,
    "sender_email": "your-email@gmail.com",
    "sender_password": "your-app-password",
    "recipient_email": "recipient@gmail.com"
  },
  "telegram": {
    "bot_token": "YOUR_BOT_TOKEN",
    "chat_id": "YOUR_CHAT_ID"
  },
  "discord": {
    "webhook_url": "YOUR_DISCORD_WEBHOOK_URL"
  }
}
EOF
```

### 5. Kiá»ƒm tra hoáº¡t Ä‘á»™ng
```bash
python3 ip_monitor.py --check-ip
```

## âš™ï¸ Cáº¥u hÃ¬nh chi tiáº¿t

### ğŸ“§ Cáº¥u hÃ¬nh Email (Gmail)

1. **Báº­t xÃ¡c thá»±c 2 bÆ°á»›c** cho Gmail
2. **Táº¡o App Password**:
   - VÃ o [Google Account Settings](https://myaccount.google.com/)
   - Security â†’ 2-Step Verification â†’ App passwords
   - Táº¡o password cho "Mail"
3. **Cáº­p nháº­t config.json**:
```json
{
  "notification_methods": ["email"],
  "email": {
    "smtp_server": "smtp.gmail.com",
    "smtp_port": 587,
    "sender_email": "your-email@gmail.com",
    "sender_password": "app-password-16-chars",
    "recipient_email": "recipient@gmail.com"
  }
}
```

### ğŸ“± Cáº¥u hÃ¬nh Telegram

1. **Táº¡o bot**:
   - Nháº¯n tin vá»›i [@BotFather](https://t.me/botfather)
   - Gá»­i `/newbot` vÃ  lÃ m theo hÆ°á»›ng dáº«n
   - LÆ°u **bot token**

2. **Láº¥y Chat ID**:
   - Nháº¯n tin vá»›i bot vá»«a táº¡o
   - Truy cáº­p: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
   - TÃ¬m "chat":{"id": YOUR_CHAT_ID}

3. **Cáº­p nháº­t config.json**:
```json
{
  "notification_methods": ["telegram"],
  "telegram": {
    "bot_token": "123456789:ABCDEF...",
    "chat_id": "123456789"
  }
}
```

### ğŸ’¬ Cáº¥u hÃ¬nh Discord

1. **Táº¡o webhook**:
   - VÃ o Discord server â†’ Server Settings
   - Integrations â†’ Webhooks â†’ New Webhook
   - Copy webhook URL

2. **Cáº­p nháº­t config.json**:
```json
{
  "notification_methods": ["discord"],
  "discord": {
    "webhook_url": "https://discord.com/api/webhooks/..."
  }
}
```

### âš¡ Cáº¥u hÃ¬nh Ä‘a kÃªnh
```json
{
  "notification_methods": ["email", "telegram", "discord"],
  // ... cáº¥u hÃ¬nh táº¥t cáº£ cÃ¡c kÃªnh
}
```

## ğŸ”§ CÃ¡ch sá»­ dá»¥ng

### Cháº¡y thá»§ cÃ´ng
```bash
# Kiá»ƒm tra IP hiá»‡n táº¡i
python3 ip_monitor.py --check-ip

# Cháº¡y bot (Ctrl+C Ä‘á»ƒ dá»«ng)
python3 ip_monitor.py

# Cháº¡y vá»›i file config tÃ¹y chá»‰nh
python3 ip_monitor.py --config my_config.json
```

### Cháº¡y nhÆ° systemd service

1. **Táº¡o service file**:
```bash
sudo tee /etc/systemd/system/ip-monitor.service > /dev/null << EOF
[Unit]
Description=IP Monitor Bot
After=network.target

[Service]
Type=simple
User=$USER
WorkingDirectory=$HOME/ip-monitor-bot
ExecStart=/usr/bin/python3 $HOME/ip-monitor-bot/ip_monitor.py
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF
```

2. **Khá»Ÿi Ä‘á»™ng service**:
```bash
# Reload systemd
sudo systemctl daemon-reload

# Enable vÃ  start service
sudo systemctl enable ip-monitor
sudo systemctl start ip-monitor

# Kiá»ƒm tra tráº¡ng thÃ¡i
sudo systemctl status ip-monitor

# Xem logs
sudo journalctl -u ip-monitor -f
```

3. **Quáº£n lÃ½ service**:
```bash
# Dá»«ng
sudo systemctl stop ip-monitor

# Khá»Ÿi Ä‘á»™ng láº¡i
sudo systemctl restart ip-monitor

# VÃ´ hiá»‡u hÃ³a
sudo systemctl disable ip-monitor
```

## ğŸ“ Xem logs

### Log file
```bash
# Xem log real-time
tail -f ~/ip-monitor-bot/ip_monitor.log

# Xem log cuá»‘i
tail -20 ~/ip-monitor-bot/ip_monitor.log
```

### System journal (náº¿u cháº¡y nhÆ° service)
```bash
# Xem log real-time
sudo journalctl -u ip-monitor -f

# Xem log hÃ´m nay
sudo journalctl -u ip-monitor --since today

# Xem log 1 giá» qua
sudo journalctl -u ip-monitor --since "1 hour ago"
```

## ğŸ› ï¸ TÃ¹y chá»‰nh nÃ¢ng cao

### Thay Ä‘á»•i táº§n suáº¥t kiá»ƒm tra
```json
{
  "check_interval": 60,  // 1 phÃºt
  // hoáº·c
  "check_interval": 1800  // 30 phÃºt
}
```

### Script tiá»‡n Ã­ch

Táº¡o script `manage.sh`:
```bash
#!/bin/bash

case "$1" in
    start)
        python3 ip_monitor.py &
        echo "Bot started in background"
        ;;
    stop)
        pkill -f ip_monitor.py
        echo "Bot stopped"
        ;;
    status)
        if pgrep -f ip_monitor.py > /dev/null; then
            echo "Bot is running"
        else
            echo "Bot is not running"
        fi
        ;;
    ip)
        python3 ip_monitor.py --check-ip
        ;;
    log)
        tail -f ip_monitor.log
        ;;
    *)
        echo "Usage: $0 {start|stop|status|ip|log}"
        ;;
esac
```

```bash
chmod +x manage.sh
./manage.sh start   # Khá»Ÿi Ä‘á»™ng
./manage.sh status  # Kiá»ƒm tra tráº¡ng thÃ¡i
./manage.sh ip      # Xem IP hiá»‡n táº¡i
./manage.sh log     # Xem log
./manage.sh stop    # Dá»«ng
```

## ğŸ› Troubleshooting

### Lá»—i thÆ°á»ng gáº·p

**1. "requests module not found"**
```bash
pip3 install requests
# hoáº·c
python3 -m pip install requests --user
```

**2. "Permission denied" khi táº¡o service**
```bash
# Äáº£m báº£o cÃ³ quyá»n sudo
sudo systemctl daemon-reload
```

**3. "Cannot get IP address"**
- Kiá»ƒm tra internet connection
- Bot sáº½ thá»­ nhiá»u service khÃ¡c nhau

**4. Email khÃ´ng gá»­i Ä‘Æ°á»£c**
- Äáº£m báº£o Ä‘Ã£ báº­t 2FA vÃ  táº¡o App Password
- Kiá»ƒm tra SMTP settings
- Test vá»›i telnet: `telnet smtp.gmail.com 587`

**5. Telegram khÃ´ng hoáº¡t Ä‘á»™ng**
- Kiá»ƒm tra bot token vÃ  chat ID
- Äáº£m báº£o Ä‘Ã£ nháº¯n tin vá»›i bot trÆ°á»›c
- Test API: `curl "https://api.telegram.org/bot<TOKEN>/getMe"`

### Debug mode

ThÃªm debug logging:
```python
logging.basicConfig(level=logging.DEBUG)
```

### Kiá»ƒm tra káº¿t ná»‘i
```bash
# Test internet
ping -c 3 8.8.8.8

# Test DNS
nslookup api.ipify.org

# Test HTTPS
curl -s https://api.ipify.org?format=json
```

## ğŸ“Š GiÃ¡m sÃ¡t

### Táº¡o simple monitoring script
```bash
#!/bin/bash
# monitor.sh

if ! pgrep -f ip_monitor.py > /dev/null; then
    echo "$(date): IP Monitor bot is down, restarting..."
    cd ~/ip-monitor-bot
    python3 ip_monitor.py &
fi
```

ThÃªm vÃ o crontab:
```bash
crontab -e
# ThÃªm dÃ²ng nÃ y Ä‘á»ƒ kiá»ƒm tra má»—i 5 phÃºt
*/5 * * * * /path/to/monitor.sh
```

## ğŸ” Báº£o máº­t

- **KhÃ´ng commit** file `config.json` lÃªn git
- **Sá»­ dá»¥ng App Password** thay vÃ¬ password tháº­t cho email
- **Giá»›i háº¡n quyá»n file**: `chmod 600 config.json`
- **Cháº¡y vá»›i user thÆ°á»ng**, khÃ´ng dÃ¹ng root

## ğŸ“ˆ Performance

- **CPU usage**: ~0.1% khi idle
- **Memory usage**: ~10-20MB
- **Network**: 1-2KB per check
- **Disk**: Log file tÄƒng ~1MB/thÃ¡ng

## ğŸ¤ ÄÃ³ng gÃ³p

1. Fork repository
2. Táº¡o feature branch
3. Commit changes
4. Push vÃ  táº¡o Pull Request

## ğŸ“„ License

MIT License - xem file LICENSE Ä‘á»ƒ biáº¿t chi tiáº¿t.

## ğŸ†˜ Há»— trá»£

- **Issues**: Táº¡o issue trÃªn GitHub
- **Email**: your-email@domain.com
- **Telegram**: @yourusername

---

**â­ Náº¿u project há»¯u Ã­ch, hÃ£y star repository!**